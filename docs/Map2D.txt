/*
   Conservative Creator's Engine - open source engine for making games.
   Copyright Â© 2020-2023 Andrey Gaivoronskiy

   This file is part of Conservative Creator's Engine.

   Copying and distribution of this file, with or without modification,
   are permitted in any medium without royalty provided the copyright
   notice and this notice are preserved.  This file is offered as-is,
   without any warranty.
*/

#include "map2D.h"

2Dmap file structure:

uint8_t headSize

HEAD:
char resourcesToLoad[8];
uint16_t resourcesToLoadQuantity
char renderingInformation[8]
uint16_t renderingInformationHeadSize
char colliderInformation[8]
uint16_t colliderInformationHeadSize
char actionInformation[8]
uint16_t actionInformationHeadSize
char openWorldInformation[8]
uint16_t openworldInformationHeadSize
char SOME_GAME-SPECIFIC_INFORMATION[8];
uint16_t SOME_GAME-SPECIFIC_INFORMATION_HEAD_SIZE

RESOURCES:
uint32_t texturesNamesSize
uint32_t soundsNamesSize
GAME-SPECIFIC_RESOURCES_NAMES_SIZE

char     textureNames   [texturesNamesSize]
char     soundNames     [soundsNamesSize]
GAME-SPECIFIC_RESOURCES [SPECIFIC_RESOURCES_NAMES_SIZE]

RENDERING_INFORMATION:
uint16_t elementInfoQuantity
uint32_t elementsTotal
uint32_t elementsQuantity               [renderingInformationHeadSize]

struct ElementInfo          elementInfo [elementInfoQuantity]
struct Map2DElementPosition elements    [elementsQuantity][headSize]

COLLIDER_INFORMATION:
uint32_t              collidersQuantity
uint16_t              transformGroupsQuantity
uint16_t              collisionGroupsQuantity
uint16_t              collisionQuantity

struct Collider       colliders       [collidersQuantity]
struct ElementGroup   transformGroups [transformGroupsQuantity]  // Groups can be used to transform Colliders (rotation of colliders is unsupported)
struct ElementGroup   collisionGroups [collisionGroupsQuantity]
struct CollisionGroup collision       [collisionQuantity]

ACTIONS:
uint16_t      onLoadActionsQuantity
uint16_t      onFreeActionsQuantity
uint32_t      onLoadActionsSize
uint32_t      onFreeActionsSize

uint16_t      onLoadActionSizes [onLoadActionsQuantity]
struct Action onLoadActions     [onLoadActionsSize]
uint16_t      onFreeActionSizes [onFreeActionsQuantity]
struct Action onFreeActions     [onFreeActionsSize]

OPENWORLD:
uint8_t        exitMapQuantity
uint32_t       exitMapNamesSize
uint16_t       onEnterActionsQuantity
uint16_t       onLeaveActionsQuantity
uint32_t       onEnterActionsSize
uint32_t       onLeaveActionsSize

struct ExitMap exitMaps
char           exitMapNames [exitMapNamesSize]
uint16_t       onEnterActionSizes [onEnterActionsQuantity]
struct Action  onEnterActions     [onEnterActionsSize]
uint16_t       onLeaveActionSizes [onLeaveActionsQuantity]
struct Action  onLeaveActions     [onLeaveActionsSize]

GAME_DATA:
Some data that engine doesn't know how to parse // Handles via external functions provided by the running game
